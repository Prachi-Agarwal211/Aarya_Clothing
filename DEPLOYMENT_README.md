# Aarya Clothing - VPS Deployment Instructions

## Quick Start - Deploy to Your VPS Now!

Your VPS is ready for deployment. Follow these steps:

### Step 1: SSH into your VPS
```bash
ssh root@72.61.255.8
```

### Step 2: Navigate to project directory
```bash
cd /opt/Aarya_Clothing
```

### Step 3: Make scripts executable
```bash
chmod +x setup-ssl.sh deploy-vps.sh health-check.sh
```

### Step 4: Run deployment
```bash
./deploy-vps.sh
```

That's it! Your application will be deployed and accessible at:
- **Frontend**: https://aaryaclothing.cloud
- **API**: https://aaryaclothing.cloud/api/

---

## What's Been Configured

### ✅ Docker Compose (docker-compose.yml)
- All services configured for production
- Domain: aaryaclothing.cloud
- CORS origins set to your domain
- Nginx reverse proxy included
- SSL certificate mounting configured

### ✅ Nginx Configuration (docker/nginx/nginx.prod.conf)
- HTTP to HTTPS redirect
- SSL/TLS configuration
- API routing to correct services
- Security headers
- Rate limiting
- Gzip compression

### ✅ Environment Variables (.env)
- Production environment configured
- Database credentials set
- JWT secrets configured
- Redis connection configured

### ✅ Deployment Scripts Created
1. **setup-ssl.sh** - Generates SSL certificates
2. **deploy-vps.sh** - Complete deployment automation
3. **health-check.sh** - Verify all services are running

---

## Deployment Architecture

```
Internet (HTTPS)
    ↓
Nginx (Port 443/80)
    ↓
├── Frontend (Next.js - Port 3000)
├── Core API (Port 8001) - Auth & Users
├── Commerce API (Port 8010) - Products, Cart, Orders
├── Payment API (Port 8020) - Payment Processing
├── PostgreSQL (Port 5432) - Database
└── Redis (Port 6379) - Cache & Sessions
```

---

## Access Points After Deployment

### Frontend
- **URL**: https://aaryaclothing.cloud
- **Description**: Main e-commerce website

### API Endpoints
- **Auth**: https://aaryaclothing.cloud/api/auth/
- **Users**: https://aaryaclothing.cloud/api/users/
- **Products**: https://aaryaclothing.cloud/api/products/
- **Categories**: https://aaryaclothing.cloud/api/categories/
- **Cart**: https://aaryaclothing.cloud/api/cart/
- **Orders**: https://aaryaclothing.cloud/api/orders/
- **Payments**: https://aaryaclothing.cloud/api/payments/
- **Health**: https://aaryaclothing.cloud/health

---

## Common Commands

### Check if services are running
```bash
docker-compose ps
```

### View logs
```bash
# All services
docker-compose logs -f

# Specific service
docker-compose logs -f nginx
docker-compose logs -f frontend
docker-compose logs -f core
```

### Restart services
```bash
# All services
docker-compose restart

# Specific service
docker-compose restart nginx
```

### Stop all services
```bash
docker-compose down
```

### Start all services
```bash
docker-compose up -d
```

### Run health check
```bash
./health-check.sh
```

---

## SSL Certificate Information

### Current Setup: Self-Signed Certificates
- Automatically generated by `setup-ssl.sh`
- Valid for 365 days
- Browser will show security warning (normal for self-signed)
- **Action**: Accept the warning to proceed

### Production SSL (Recommended)
For production, use Let's Encrypt:

```bash
# Install certbot
apt-get update
apt-get install certbot

# Generate certificates
certbot certonly --standalone -d aaryaclothing.cloud -d www.aaryaclothing.cloud

# Copy certificates
cp /etc/letsencrypt/live/aaryaclothing.cloud/fullchain.pem docker/nginx/ssl/aaryaclothing.cloud.crt
cp /etc/letsencrypt/live/aaryaclothing.cloud/privkey.pem docker/nginx/ssl/aaryaclothing.cloud.key

# Restart nginx
docker-compose restart nginx
```

---

## Troubleshooting

### Services not starting
```bash
# Check logs
docker-compose logs

# Check disk space
df -h
```

### Database connection issues
```bash
# Check PostgreSQL
docker exec -it aarya_postgres pg_isready -U postgres

# Connect to database
docker exec -it aarya_postgres psql -U postgres -d aarya_clothing
```

### Nginx issues
```bash
# Test nginx config
docker exec -it aarya_nginx nginx -t

# Reload nginx
docker exec -it aarya_nginx nginx -s reload
```

### Port conflicts
```bash
# Check what's using ports
netstat -tulpn | grep :80
netstat -tulpn | grep :443
```

---

## Firewall Configuration

Ensure ports 80 and 443 are open:

```bash
# UFW (Ubuntu/Debian)
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable

# Check status
ufw status
```

---

## Monitoring

### Check service health
```bash
./health-check.sh
```

### View resource usage
```bash
docker stats
```

### View recent logs
```bash
docker-compose logs --tail=100
```

---

## Backup

### Backup database
```bash
docker exec aarya_postgres pg_dump -U postgres aarya_clothing > backup_$(date +%Y%m%d).sql
```

### Backup volumes
```bash
docker run --rm -v aarya_postgres_data:/data -v $(pwd):/backup alpine tar czf /backup/postgres_backup.tar.gz /data
```

---

## Updates

### Update code and redeploy
```bash
git pull
docker-compose up -d --build
```

### Update specific service
```bash
docker-compose up -d --build frontend
```

---

## Security Checklist

- [x] Strong passwords in .env
- [x] JWT secrets configured
- [x] SSL certificates enabled
- [x] CORS origins restricted to domain
- [ ] Firewall configured (ports 80, 443 only)
- [ ] Production SSL certificates (Let's Encrypt)
- [ ] Regular backups scheduled
- [ ] Monitoring set up

---

## Success Indicators

✅ All containers show "Up" status in `docker-compose ps`
✅ Frontend loads at https://aaryaclothing.cloud
✅ API endpoints return responses
✅ No errors in logs
✅ Health check returns 200 OK
✅ SSL certificate is valid (or accepted for self-signed)

---

## Documentation

- **VPS_SETUP_GUIDE.md** - Comprehensive deployment guide
- **VPS_DEPLOYMENT.md** - Original deployment documentation
- **docs/deployment-guide.md** - General deployment guide

---

## Support

If you encounter issues:

1. Check logs: `docker-compose logs -f`
2. Run health check: `./health-check.sh`
3. Verify configuration: `docker-compose config`
4. Test connectivity: `curl https://aaryaclothing.cloud/health`

---

## Deployment Summary

**VPS IP**: 72.61.255.8
**Domain**: aaryaclothing.cloud
**Environment**: Production
**SSL**: Self-signed (upgrade to Let's Encrypt for production)
**Status**: Ready to deploy

**Next Step**: Run `./deploy-vps.sh` on your VPS!

---

*Last Updated: 2026-02-09*
